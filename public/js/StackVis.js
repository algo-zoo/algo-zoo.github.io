!function(r,e,t,o,n){var i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},a="function"==typeof i[o]&&i[o],u=a.cache||{},l="undefined"!=typeof module&&"function"==typeof module.require&&module.require.bind(module);function p(e,t){if(!u[e]){if(!r[e]){var n="function"==typeof i[o]&&i[o];if(!t&&n)return n(e,!0);if(a)return a(e,!0);if(l&&"string"==typeof e)return l(e);var s=Error("Cannot find module '"+e+"'");throw s.code="MODULE_NOT_FOUND",s}c.resolve=function(t){var o=r[e][1][t];return null!=o?o:t},c.cache={};var f=u[e]=new p.Module(e);r[e][0].call(f.exports,c,f,f.exports,i)}return u[e].exports;function c(r){var e=c.resolve(r);return!1===e?{}:p(e)}}p.isParcelRequire=!0,p.Module=function(r){this.id=r,this.bundle=p,this.exports={}},p.modules=r,p.cache=u,p.parent=a,p.register=function(e,t){r[e]=[function(r,e){e.exports=t},{}]},Object.defineProperty(p,"root",{get:function(){return i[o]}}),i[o]=p;for(var s=0;s<e.length;s++)p(e[s]);if(t){var f=p(t);"object"==typeof exports&&"undefined"!=typeof module?module.exports=f:"function"==typeof define&&define.amd&&define(function(){return f})}}({dAPiW:[function(r,e,t,o){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t),n.export(t,"padding",()=>D),n.export(t,"boxSize",()=>f),n.export(t,"halfBoxSize",()=>c),n.export(t,"quarterBoxSize",()=>d),n.export(t,"cellSize",()=>v),n.export(t,"state",()=>x),n.export(t,"drawBox",()=>h),n.export(t,"drawBoxByIndex",()=>m),n.export(t,"drawLabel",()=>g),n.export(t,"drawCodeLabel",()=>j),n.export(t,"drawArrow",()=>_),n.export(t,"drawArrowByIndex",()=>E),n.export(t,"drawStack",()=>S),n.export(t,"loadProgram",()=>O),n.export(t,"runStack",()=>k),n.export(t,"getStackState",()=>M),n.export(t,"getMaxStackLength",()=>b),n.export(t,"setDisable",()=>y),n.export(t,"refreshButtons",()=>T),n.export(t,"isCode",()=>w),n.export(t,"draw",()=>C),n.export(t,"setHeight",()=>N),n.export(t,"initializeStack",()=>I),n.export(t,"setup",()=>P),n.export(t,"createCanvas",()=>B),n.export(t,"run",()=>A),n.export(t,"prev",()=>R),n.export(t,"next",()=>F);var i=r("./P5.js"),a=r("./DrawUtil.js"),u=r("./ColorCode.js"),l=r("@rescript/core/src/Core__Int.js"),p=r("@rescript/core/src/Core__Array.js"),s=r("@rescript/core/src/Core__Option.js"),f=(Math.sqrt(2)*a.nodeRadius|0)<<1,c=f/2|0,d=f/4|0,v=f+24|0,x={index:{contents:void 0}};function h(r,e,t){strokeWeight(a.strokeWeight),i.strokeColor(u.black),i.fillColor(u.lightBlue),rect(r-(f/2|0)|0,e-(f/2|0)|0,f,f),a.drawNode(r,e,t)}function m(r,e,t){h((12+(f/2|0)|0)+Math.imul(e,v)|0,(12+(f/2|0)|0)+Math.imul(t,v)|0,r)}function g(r,e,t){var o=Math.imul(e,v)+12|0,n=Math.imul(t,v)+(v/2|0)|0;textSize(40),strokeWeight(3),i.strokeColor(u.black),i.fillColor(u.red),textAlign(LEFT,CENTER),text(r,o,n)}function j(r,e){var t=r[e];if(void 0!==t)return"object"!=typeof t?"Pop"===t?g("pop()",2,0):void 0:"PushShow"===t.TAG?g("push("+String(t._0)+")",2,0):void 0}function _(r,e,t){var o=function(r){strokeWeight(a.strokeWeight),i.strokeColor(u.black),i.fillColor(u.white),beginShape(),r.forEach(function(r){vertex(r[0],r[1])}),endShape(CLOSE)};if(void 0!==t&&t){var n=[r,e];return o([n,[r+c|0,e-c|0],[r+c|0,e-d|0],[r+f|0,e-d|0],[r+f|0,e+d|0],[r+c|0,e+d|0],[r+c|0,e+c|0],n])}var l=[r,e-d|0];o([l,[r+c|0,e-d|0],[r+c|0,e-c|0],[r+f|0,e],[r+c|0,e+c|0],[r+c|0,e+d|0],[r,e+d|0],l])}function E(r,e,t){_(12+Math.imul(r,v)|0,(12+c|0)+Math.imul(e,v)|0,void 0!==t&&t)}function S(r,e,t,o){var n=void 0!==t?t:2,l=void 0!==o?o:1;r.forEach(function(r,t){m(r,((e-t|0)-1|0)+n|0,l)});var p=(12+Math.imul(n,v)|0)+(v/2|0)|0,s=12+Math.imul(l,v)|0,f=(p-(v/2|0)|0)-12|0,c=f+Math.imul(e,v)|0,d=s-12|0,x=(s+v|0)-12|0;strokeWeight(a.strokeWeight<<1),i.strokeColor(u.black),line(f,d,c,d),line(f,x,c,x),line(c,d,c,x)}function O(){var r=$("#program").val(),e=RegExp("push\\((\\d+)\\)"),t=RegExp("pop\\(\\)"),o=[];return r.split("\n").forEach(function(r){var n=e.exec(r);if(null==n){if(!t.test(r))return;o.push("Pop"),o.push("PopPause");return}var i=n.slice(1)[0],a=s.getExn(l.fromString(i,void 0),void 0);o.push({TAG:"PushShow",_0:a}),o.push({TAG:"Push",_0:a})}),o}function k(r,e){for(var t=[],o=0;;){var n,i,a=n,u=o;if(e<u)return[t,a];var l=r[u];"object"!=typeof l?i="Pop"===l?t.pop():void 0:"PushShow"===l.TAG?i=l._0:(t.push(l._0),i=void 0),n=i,o=u+1|0}}function M(r,e){return 0<=e&&e<r.length?k(r,e):[[],void 0]}function b(r){return p.reduce(p.fromInitializer(r.length,function(e){return M(r,e)[0].length}),0,function(r,e){return r<e?e:r})}var y=(r,e)=>$(r).prop("disabled",e);function T(){var r=x.index.contents;if(void 0!==r){var e=O().length;y("#prev",-1===r),y("#next",(r+1|0)===e)}}function w(r,e,t){var o=r[e];return void 0!==o&&("object"!=typeof o?"Pop"===o&&"pop"===t:"PushShow"===o.TAG&&"push"===t)}function C(){background(200);var r=x.index.contents;if(void 0!==r){var e=O(),t=b(e),o=M(e,r),n=o[1];j(e,r),S(o[0].map(function(r){return String(r)}),t,2,1),w(e,r,"push")?(E(1,1,void 0),m(String(s.getExn(n,void 0)),0,1)):w(e,r,"pop")&&(E(1,1,!0),m(String(s.getExn(n,void 0)),0,1)),T()}}var N=r=>$(r).height($(r)[0].scrollHeight);function I(){var r="#program";$(r).val("push(4)\npush(2)\npush(9)\npop()\npush(1)\npop()\npush(9)\npush(7)\npush(6)"),N(r)}function P(){createCanvas(0,0).parent("canvas-hole"),y("#prev",!0),y("#next",!0),I()}function B(){var r=Math.imul(v,3);createCanvas(Math.imul(v,b(O())+4|0),r).parent("canvas-hole"),noLoop()}function A(){B(),x.index.contents=-1}function R(){var r=x.index.contents;if(void 0!==r&&0<=r){x.index.contents=r-1|0;return}}function F(){var r=x.index.contents;if(void 0!==r&&r<(O().length-1|0)){x.index.contents=r+1|0;return}}$(document).ready(function(){[["#run",A],["#prev",R],["#next",F]].forEach(function(r){var e=r[1];$(r[0]).on("click",function(){e(),redraw()})})}),window.setup=P,window.draw=C;var D=12},{"./P5.js":"kRQjY","./DrawUtil.js":"d335M","./ColorCode.js":"fgi4l","@rescript/core/src/Core__Int.js":"da5Bi","@rescript/core/src/Core__Array.js":"kmH7i","@rescript/core/src/Core__Option.js":"4Dake","@parcel/transformer-js/src/esmodule-helpers.js":"jBTt3"}],kRQjY:[function(r,e,t,o){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");function i(r){fill.apply(null,r)}function a(r){stroke.apply(null,r)}n.defineInteropFlag(t),n.export(t,"fillColor",()=>i),n.export(t,"strokeColor",()=>a)},{"@parcel/transformer-js/src/esmodule-helpers.js":"jBTt3"}],jBTt3:[function(r,e,t,o){t.interopDefault=function(r){return r&&r.__esModule?r:{default:r}},t.defineInteropFlag=function(r){Object.defineProperty(r,"__esModule",{value:!0})},t.exportAll=function(r,e){return Object.keys(r).forEach(function(t){"default"===t||"__esModule"===t||Object.prototype.hasOwnProperty.call(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:function(){return r[t]}})}),e},t.export=function(r,e,t){Object.defineProperty(r,e,{enumerable:!0,get:t})}},{}],d335M:[function(r,e,t,o){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t),n.export(t,"strokeWeight",()=>f),n.export(t,"textSize",()=>c),n.export(t,"nodeRadius",()=>d),n.export(t,"drawNode",()=>u),n.export(t,"epsilon",()=>v),n.export(t,"calc_dist",()=>l),n.export(t,"calc_edge_point",()=>p),n.export(t,"rotation",()=>s);var i=r("./P5.js"),a=r("./ColorCode.js");function u(r,e,t){strokeWeight(2),i.fillColor(a.white),ellipse(r,e,50,50),textAlign(CENTER,CENTER),textSize(24),i.fillColor(a.black),text(t,r,e)}var l=function(r,e,t,o){return Math.sqrt((r-t)**2+(e-o)**2)},p=function(r,e,t,o,n,i,a){r==t&&(r+=v);let u=(o-e)/(t-r),p=a/Math.sqrt(1+u*u),[s,f]=[r+p,e+u*p],[c,d]=[r-p,e-u*p],[x,h]=[(r+t)/2,(e+o)/2];return l(s,f,x,h)<l(c,d,x,h)?[s,f]:[c,d]},s=function(r,e,t,o,n){return[(t-r)*Math.cos(n)-(o-e)*Math.sin(n)+r,(t-r)*Math.sin(n)+(o-e)*Math.cos(n)+e]},f=2,c=24,d=25,v=1e-5},{"./P5.js":"kRQjY","./ColorCode.js":"fgi4l","@parcel/transformer-js/src/esmodule-helpers.js":"jBTt3"}],fgi4l:[function(r,e,t,o){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");function i(r){return console.assert(0<=r&&r<=255,"Scale error"),[r,r,r]}function a(r,e,t){console.assert(0<=r&&r<=360,"Scale error"),console.assert(0<=e&&e<=100,"Scale error"),console.assert(0<=t&&t<=100,"Scale error");var o,n=function(r){return 0|Math.round(255*r)},i=e/100,a=t/100;if(0===e){var u=n(a);return[u,u,u]}var l=r/60,p=0|Math.floor(l),s=l-p,f=a*(1-i),c=a*(1-i*s),d=a*(1-i*(1-s));switch(p){case 0:o=[a,d,f];break;case 1:o=[c,a,f];break;case 2:o=[f,a,d];break;case 3:o=[f,c,a];break;case 4:o=[d,f,a];break;default:o=[a,f,c]}return[n(o[0]),n(o[1]),n(o[2])]}n.defineInteropFlag(t),n.export(t,"grayScale",()=>i),n.export(t,"hsv",()=>a),n.export(t,"black",()=>u),n.export(t,"dark",()=>l),n.export(t,"gray",()=>p),n.export(t,"lightGray",()=>s),n.export(t,"white",()=>f),n.export(t,"red",()=>c),n.export(t,"yellow",()=>d),n.export(t,"blue",()=>v),n.export(t,"lightBlue",()=>x),n.export(t,"orange",()=>h);var u=i(0),l=i(30),p=i(120),s=i(180),f=i(255),c=a(18,80,100),d=a(57,80,100),v=a(200,80,100),x=a(200,20,100),h=a(40,80,100)},{"@parcel/transformer-js/src/esmodule-helpers.js":"jBTt3"}],da5Bi:[function(r,e,t,o){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t),n.export(t,"Constants",()=>f),n.export(t,"fromString",()=>a),n.export(t,"range",()=>u),n.export(t,"rangeWithOptions",()=>l),n.export(t,"clamp",()=>p),n.export(t,"Bitwise",()=>s);var i=r("./Core__Array.js");function a(r,e){var t=void 0!==e?parseInt(r,e):parseInt(r);if(!isNaN(t)&&!(t>0x7fffffff)&&!(t<-0x80000000))return 0|t}function u(r,e,t){var o,n,a=void 0!==t?t:{},u=r>e,l=a.step;if(void 0!==l){if(0!==l)o=l;else{if(r!==e)throw RangeError("Incorrect range arguments");o=l}}else o=u?-1:1;if(u===o>=0)n=0;else if(0===o)n=+(!0===a.inclusive);else{var p,s=u?r-e|0:e-r|0;n=0|Math.ceil((!0===a.inclusive?s+1|0:s)/((p=o)>=0?p:0|-p))}return i.fromInitializer(n,function(e){return r+Math.imul(e,o)|0})}function l(r,e,t){return u(r,e,t)}function p(r,e,t){var o=void 0!==e&&e<t?e:t;return void 0!==r&&r>o?r:o}var s={lnot:function(r){return -1^r}},f={minValue:-0x80000000,maxValue:0x7fffffff}},{"./Core__Array.js":"kmH7i","@parcel/transformer-js/src/esmodule-helpers.js":"jBTt3"}],kmH7i:[function(r,e,t,o){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t),n.export(t,"make",()=>a),n.export(t,"fromInitializer",()=>u),n.export(t,"equal",()=>l),n.export(t,"compare",()=>p),n.export(t,"indexOfOpt",()=>s),n.export(t,"lastIndexOfOpt",()=>f),n.export(t,"reduce",()=>c),n.export(t,"reduceWithIndex",()=>d),n.export(t,"reduceRight",()=>v),n.export(t,"reduceRightWithIndex",()=>x),n.export(t,"findIndexOpt",()=>h),n.export(t,"filterMap",()=>j),n.export(t,"keepSome",()=>_),n.export(t,"toShuffled",()=>g),n.export(t,"shuffle",()=>m),n.export(t,"findMap",()=>E),n.export(t,"last",()=>S);var i=r("rescript/lib/es6/caml_option.js");function a(r,e){if(r<=0)return[];var t=Array(r);return t.fill(e),t}function u(r,e){if(r<=0)return[];for(var t=Array(r),o=0;o<r;++o)t[o]=e(o);return t}function l(r,e,t){var o=r.length;if(o!==e.length)return!1;for(var n=0;;){var i=n;if(i===o)return!0;if(!t(r[i],e[i]))return!1;n=i+1|0}}function p(r,e,t){var o=r.length,n=e.length;if(o<n)return -1;if(o>n)return 1;for(var i=0;;){var a=i;if(a===o)return 0;var u=t(r[a],e[a]);if(0!==u)return u;i=a+1|0}}function s(r,e){var t=r.indexOf(e);if(-1!==t)return t}function f(r,e){var t=r.lastIndexOf(e);if(-1!==t)return t}function c(r,e,t){return r.reduce(t,e)}function d(r,e,t){return r.reduce(t,e)}function v(r,e,t){return r.reduceRight(t,e)}function x(r,e,t){return r.reduceRight(t,e)}function h(r,e){var t=r.findIndex(e);if(-1!==t)return t}function m(r){for(var e,t=r.length,o=0;o<t;++o)!function(r,e,t){var o=r[e];r[e]=r[t],r[t]=o}(r,o,(0|Math.floor(Math.random()*(t-(e=o)|0)))+e|0)}function g(r){var e=r.slice();return m(e),e}function j(r,e){for(var t=r.length,o=Array(t),n=0,a=0;a<t;++a){var u=e(r[a]);void 0!==u&&(o[n]=i.valFromOption(u),n=n+1|0)}return o.length=n,o}function _(r){return j(r,function(r){return r})}function E(r,e){for(var t=0;;){var o=t;if(o===r.length)return;var n=e(r[o]);if(void 0!==n)return n;t=o+1|0}}function S(r){return r[r.length-1|0]}},{"rescript/lib/es6/caml_option.js":"lBDcT","@parcel/transformer-js/src/esmodule-helpers.js":"jBTt3"}],lBDcT:[function(r,e,t,o){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");function i(r){return void 0!==r.BS_PRIVATE_NESTED_SOME_NONE}function a(r){return void 0===r?{BS_PRIVATE_NESTED_SOME_NONE:0}:null!==r&&void 0!==r.BS_PRIVATE_NESTED_SOME_NONE?{BS_PRIVATE_NESTED_SOME_NONE:r.BS_PRIVATE_NESTED_SOME_NONE+1|0}:r}function u(r){if(null!=r)return a(r)}function l(r){if(void 0!==r)return a(r)}function p(r){if(null!==r)return a(r)}function s(r){if(null===r||void 0===r.BS_PRIVATE_NESTED_SOME_NONE)return r;var e=r.BS_PRIVATE_NESTED_SOME_NONE;if(0!==e)return{BS_PRIVATE_NESTED_SOME_NONE:e-1|0}}function f(r){if(void 0!==r)return s(r)}function c(r){return void 0!==r?r.VAL:r}n.defineInteropFlag(t),n.export(t,"nullable_to_opt",()=>u),n.export(t,"undefined_to_opt",()=>l),n.export(t,"null_to_opt",()=>p),n.export(t,"valFromOption",()=>s),n.export(t,"some",()=>a),n.export(t,"isNested",()=>i),n.export(t,"option_get",()=>f),n.export(t,"option_unwrap",()=>c)},{"@parcel/transformer-js/src/esmodule-helpers.js":"jBTt3"}],"4Dake":[function(r,e,t,o){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t),n.export(t,"filter",()=>u),n.export(t,"forEach",()=>l),n.export(t,"getExn",()=>p),n.export(t,"mapOr",()=>s),n.export(t,"mapWithDefault",()=>j),n.export(t,"map",()=>f),n.export(t,"flatMap",()=>c),n.export(t,"getOr",()=>d),n.export(t,"getWithDefault",()=>_),n.export(t,"orElse",()=>v),n.export(t,"isSome",()=>x),n.export(t,"isNone",()=>h),n.export(t,"equal",()=>m),n.export(t,"compare",()=>g);var i=r("rescript/lib/es6/caml_option.js"),a=r("./Core__Error.js");function u(r,e){if(void 0!==r&&e(i.valFromOption(r)))return r}function l(r,e){if(void 0!==r)return e(i.valFromOption(r))}function p(r,e){return void 0!==r?i.valFromOption(r):a.panic(void 0!==e?e:"Option.getExn called for None value")}function s(r,e,t){return void 0!==r?t(i.valFromOption(r)):e}function f(r,e){if(void 0!==r)return i.some(e(i.valFromOption(r)))}function c(r,e){if(void 0!==r)return e(i.valFromOption(r))}function d(r,e){return void 0!==r?i.valFromOption(r):e}function v(r,e){return void 0!==r?r:e}function x(r){return void 0!==r}function h(r){return void 0===r}function m(r,e,t){return void 0===r?void 0===e:void 0!==e&&t(i.valFromOption(r),i.valFromOption(e))}function g(r,e,t){return void 0!==r?void 0!==e?t(i.valFromOption(r),i.valFromOption(e)):1:void 0!==e?-1:0}var j=s,_=d},{"rescript/lib/es6/caml_option.js":"lBDcT","./Core__Error.js":"gydnd","@parcel/transformer-js/src/esmodule-helpers.js":"jBTt3"}],gydnd:[function(r,e,t,o){var n=r("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(t),n.export(t,"$$EvalError",()=>i),n.export(t,"$$RangeError",()=>a),n.export(t,"$$ReferenceError",()=>u),n.export(t,"$$SyntaxError",()=>l),n.export(t,"$$TypeError",()=>p),n.export(t,"$$URIError",()=>s),n.export(t,"panic",()=>f);var i={},a={},u={},l={},p={},s={};function f(r){throw Error("Panic! "+r)}},{"@parcel/transformer-js/src/esmodule-helpers.js":"jBTt3"}]},["dAPiW"],"dAPiW","parcelRequire94c2");
//# sourceMappingURL=StackVis.js.map
