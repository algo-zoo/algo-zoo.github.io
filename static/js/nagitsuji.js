import { color_code } from './color-code.js'

const cv = { // constant values
  w: 2270,
  h: 1300,
  node_r: 14,
  text_sz: 14,
  start_node: 440
}
var img;

const normal_mode = 0;
const path_mode = 1;
const state = {
  S: new Set(),
  mode: normal_mode,
  image_load: true,
  graph_draw: true,
}
const nodes = [
  [ "0", 152, 48 ],
  [ "1", 140, 79 ],
  [ "2", 100, 153 ],
  [ "3", 270, 2 ],
  [ "4", 228, 53 ],
  [ "5", 58, 235 ],
  [ "6", 271, 43 ],
  [ "7", 269, 52 ],
  [ "8", 230, 101 ],
  [ "9", 120, 230 ],
  [ "10", 59, 292 ],
  [ "11", 231, 149 ],
  [ "12", 311, 99 ],
  [ "13", 124, 288 ],
  [ "14", 233, 185 ],
  [ "15", 58, 360 ],
  [ "16", 384, 41 ],
  [ "17", 385, 76 ],
  [ "18", 377, 87 ],
  [ "19", 235, 236 ],
  [ "20", 325, 149 ],
  [ "21", 376, 116 ],
  [ "22", 235, 266 ],
  [ "23", 212, 290 ],
  [ "24", 223, 289 ],
  [ "25", 333, 183 ],
  [ "26", 156, 364 ],
  [ "27", 373, 159 ],
  [ "28", 173, 363 ],
  [ "29", 382, 157 ],
  [ "30", 320, 233 ],
  [ "31", 340, 216 ],
  [ "32", 53, 505 ],
  [ "33", 414, 155 ],
  [ "34", 355, 234 ],
  [ "35", 230, 363 ],
  [ "36", 51, 550 ],
  [ "37", 49, 571 ],
  [ "38", 381, 241 ],
  [ "39", 121, 509 ],
  [ "40", 153, 479 ],
  [ "41", 292, 343 ],
  [ "42", 419, 236 ],
  [ "43", 45, 614 ],
  [ "44", 381, 291 ],
  [ "45", 120, 552 ],
  [ "46", 448, 233 ],
  [ "47", 7, 685 ],
  [ "48", 577, 119 ],
  [ "49", 167, 534 ],
  [ "50", 480, 228 ],
  [ "51", 112, 605 ],
  [ "52", 700, 22 ],
  [ "53", 381, 344 ],
  [ "54", 46, 683 ],
  [ "55", 639, 118 ],
  [ "56", 165, 610 ],
  [ "57", 104, 676 ],
  [ "58", 6, 784 ],
  [ "59", 450, 341 ],
  [ "60", 574, 223 ],
  [ "61", 226, 573 ],
  [ "62", 528, 273 ],
  [ "63", 698, 116 ],
  [ "64", 638, 183 ],
  [ "65", 698, 125 ],
  [ "66", 384, 442 ],
  [ "67", 620, 209 ],
  [ "68", 46, 784 ],
  [ "69", 487, 343 ],
  [ "70", 163, 671 ],
  [ "71", 116, 741 ],
  [ "72", 338, 520 ],
  [ "73", 88, 785 ],
  [ "74", 533, 346 ],
  [ "75", 220, 665 ],
  [ "76", 549, 346 ],
  [ "77", 865, 30 ],
  [ "78", 5, 891 ],
  [ "79", 690, 209 ],
  [ "80", 116, 784 ],
  [ "81", 774, 128 ],
  [ "82", 381, 526 ],
  [ "83", 87, 823 ],
  [ "84", 575, 345 ],
  [ "85", 582, 338 ],
  [ "86", 786, 139 ],
  [ "87", 204, 725 ],
  [ "88", 284, 661 ],
  [ "89", 861, 88 ],
  [ "90", 172, 786 ],
  [ "91", 548, 426 ],
  [ "92", 489, 488 ],
  [ "93", 860, 120 ],
  [ "94", 203, 784 ],
  [ "95", 781, 207 ],
  [ "96", 682, 308 ],
  [ "97", 627, 366 ],
  [ "98", 7, 989 ],
  [ "99", 576, 425 ],
  [ "100", 558, 444 ],
  [ "101", 912, 93 ],
  [ "102", 283, 724 ],
  [ "103", 1004, 10 ],
  [ "104", 534, 488 ],
  [ "105", 361, 664 ],
  [ "106", 910, 122 ],
  [ "107", 371, 663 ],
  [ "108", 999, 40 ],
  [ "109", 558, 483 ],
  [ "110", 649, 396 ],
  [ "111", 171, 892 ],
  [ "112", 282, 785 ],
  [ "113", 344, 723 ],
  [ "114", 359, 715 ],
  [ "115", 991, 98 ],
  [ "116", 669, 431 ],
  [ "117", 8, 1096 ],
  [ "118", 466, 667 ],
  [ "119", 558, 589 ],
  [ "120", 1084, 64 ],
  [ "121", 669, 481 ],
  [ "122", 169, 988 ],
  [ "123", 489, 670 ],
  [ "124", 1169, 9 ],
  [ "125", 510, 669 ],
  [ "126", 393, 788 ],
  [ "127", 112, 1096 ],
  [ "128", 747, 464 ],
  [ "129", 1119, 93 ],
  [ "130", 610, 604 ],
  [ "131", 553, 675 ],
  [ "132", 1130, 100 ],
  [ "133", 1042, 191 ],
  [ "134", 672, 569 ],
  [ "135", 1051, 193 ],
  [ "136", 780, 465 ],
  [ "137", 680, 578 ],
  [ "138", 964, 296 ],
  [ "139", 282, 988 ],
  [ "140", 487, 788 ],
  [ "141", 674, 604 ],
  [ "142", 601, 677 ],
  [ "143", 551, 731 ],
  [ "144", 1094, 195 ],
  [ "145", 1046, 246 ],
  [ "146", 111, 1198 ],
  [ "147", 672, 642 ],
  [ "148", 743, 572 ],
  [ "149", 1116, 203 ],
  [ "150", 671, 666 ],
  [ "151", 550, 787 ],
  [ "152", 773, 571 ],
  [ "153", 664, 683 ],
  [ "154", 1104, 246 ],
  [ "155", 164, 1198 ],
  [ "156", 577, 788 ],
  [ "157", 111, 1266 ],
  [ "158", 391, 987 ],
  [ "159", 281, 1097 ],
  [ "160", 809, 574 ],
  [ "161", 536, 854 ],
  [ "162", 961, 433 ],
  [ "163", 1395, 1 ],
  [ "164", 1219, 180 ],
  [ "165", 111, 1295 ],
  [ "166", 220, 1197 ],
  [ "167", 576, 853 ],
  [ "168", 163, 1266 ],
  [ "169", 922, 514 ],
  [ "170", 667, 776 ],
  [ "171", 806, 639 ],
  [ "172", 280, 1172 ],
  [ "173", 667, 787 ],
  [ "174", 807, 647 ],
  [ "175", 922, 539 ],
  [ "176", 1264, 200 ],
  [ "177", 614, 853 ],
  [ "178", 484, 988 ],
  [ "179", 960, 515 ],
  [ "180", 1262, 214 ],
  [ "181", 280, 1197 ],
  [ "182", 1388, 91 ],
  [ "183", 1472, 9 ],
  [ "184", 907, 578 ],
  [ "185", 960, 532 ],
  [ "186", 325, 1173 ],
  [ "187", 667, 832 ],
  [ "188", 723, 777 ],
  [ "189", 959, 543 ],
  [ "190", 221, 1285 ],
  [ "191", 281, 1229 ],
  [ "192", 454, 1058 ],
  [ "193", 751, 769 ],
  [ "194", 805, 716 ],
  [ "195", 687, 836 ],
  [ "196", 361, 1164 ],
  [ "197", 229, 1299 ],
  [ "198", 902, 634 ],
  [ "199", 1456, 84 ],
  [ "200", 960, 581 ],
  [ "201", 483, 1059 ],
  [ "202", 1248, 294 ],
  [ "203", 899, 650 ],
  [ "204", 1037, 514 ],
  [ "205", 1105, 448 ],
  [ "206", 802, 753 ],
  [ "207", 301, 1262 ],
  [ "208", 575, 989 ],
  [ "209", 1078, 486 ],
  [ "210", 796, 769 ],
  [ "211", 1036, 533 ],
  [ "212", 865, 715 ],
  [ "213", 521, 1061 ],
  [ "214", 482, 1103 ],
  [ "215", 351, 1234 ],
  [ "216", 666, 921 ],
  [ "217", 360, 1227 ],
  [ "218", 1122, 466 ],
  [ "219", 953, 636 ],
  [ "220", 1017, 584 ],
  [ "221", 1111, 493 ],
  [ "222", 1224, 387 ],
  [ "223", 319, 1293 ],
  [ "224", 824, 792 ],
  [ "225", 1035, 584 ],
  [ "226", 1110, 513 ],
  [ "227", 892, 737 ],
  [ "228", 793, 841 ],
  [ "229", 465, 1173 ],
  [ "230", 1013, 627 ],
  [ "231", 805, 842 ],
  [ "232", 666, 990 ],
  [ "233", 511, 1145 ],
  [ "234", 1458, 203 ],
  [ "235", 824, 841 ],
  [ "236", 1191, 481 ],
  [ "237", 384, 1292 ],
  [ "238", 1367, 313 ],
  [ "239", 1100, 586 ],
  [ "240", 1491, 204 ],
  [ "241", 1174, 531 ],
  [ "242", 1308, 400 ],
  [ "243", 1077, 635 ],
  [ "244", 978, 740 ],
  [ "245", 496, 1225 ],
  [ "246", 880, 841 ],
  [ "247", 1712, 12 ],
  [ "248", 665, 1060 ],
  [ "249", 805, 923 ],
  [ "250", 889, 839 ],
  [ "251", 1527, 204 ],
  [ "252", 1076, 657 ],
  [ "253", 1490, 245 ],
  [ "254", 1481, 256 ],
  [ "255", 1000, 740 ],
  [ "256", 1159, 586 ],
  [ "257", 545, 1207 ],
  [ "258", 531, 1236 ],
  [ "259", 882, 888 ],
  [ "260", 1351, 426 ],
  [ "261", 787, 993 ],
  [ "262", 805, 981 ],
  [ "263", 950, 838 ],
  [ "264", 1593, 207 ],
  [ "265", 1367, 440 ],
  [ "266", 971, 837 ],
  [ "267", 1063, 747 ],
  [ "268", 1703, 111 ],
  [ "269", 557, 1286 ],
  [ "270", 867, 982 ],
  [ "271", 582, 1271 ],
  [ "272", 813, 1040 ],
  [ "273", 1482, 372 ],
  [ "274", 1107, 761 ],
  [ "275", 1493, 376 ],
  [ "276", 1413, 458 ],
  [ "277", 1421, 467 ],
  [ "278", 1573, 315 ],
  [ "279", 1518, 379 ],
  [ "280", 866, 1034 ],
  [ "281", 1488, 422 ],
  [ "282", 1863, 47 ],
  [ "283", 1806, 107 ],
  [ "284", 1420, 495 ],
  [ "285", 1693, 223 ],
  [ "286", 737, 1181 ],
  [ "287", 948, 984 ],
  [ "288", 875, 1062 ],
  [ "289", 1082, 855 ],
  [ "290", 1431, 512 ],
  [ "291", 1337, 607 ],
  [ "292", 1558, 386 ],
  [ "293", 1573, 390 ],
  [ "294", 1742, 225 ],
  [ "295", 848, 1123 ],
  [ "296", 1827, 146 ],
  [ "297", 1852, 121 ],
  [ "298", 1690, 284 ],
  [ "299", 1867, 108 ],
  [ "300", 1896, 80 ],
  [ "301", 1972, 7 ],
  [ "302", 1681, 299 ],
  [ "303", 1458, 524 ],
  [ "304", 875, 1112 ],
  [ "305", 949, 1038 ],
  [ "306", 1660, 328 ],
  [ "307", 1558, 432 ],
  [ "308", 1332, 668 ],
  [ "309", 1693, 311 ],
  [ "310", 1686, 325 ],
  [ "311", 1455, 558 ],
  [ "312", 1620, 398 ],
  [ "313", 1850, 171 ],
  [ "314", 942, 1087 ],
  [ "315", 1680, 369 ],
  [ "316", 1904, 146 ],
  [ "317", 1452, 602 ],
  [ "318", 1050, 1010 ],
  [ "319", 1403, 670 ],
  [ "320", 1546, 527 ],
  [ "321", 1039, 1052 ],
  [ "322", 1322, 769 ],
  [ "323", 1527, 564 ],
  [ "324", 1146, 963 ],
  [ "325", 1506, 605 ],
  [ "326", 1682, 431 ],
  [ "327", 847, 1280 ],
  [ "328", 1897, 245 ],
  [ "329", 1364, 780 ],
  [ "330", 1457, 691 ],
  [ "331", 1227, 925 ],
  [ "332", 2159, 4 ],
  [ "333", 1737, 429 ],
  [ "334", 1418, 758 ],
  [ "335", 1933, 244 ],
  [ "336", 1368, 810 ],
  [ "337", 1013, 1166 ],
  [ "338", 1288, 896 ],
  [ "339", 1038, 1155 ],
  [ "340", 1376, 821 ],
  [ "341", 1955, 243 ],
  [ "342", 1916, 286 ],
  [ "343", 1319, 884 ],
  [ "344", 2119, 87 ],
  [ "345", 1669, 549 ],
  [ "346", 2088, 147 ],
  [ "347", 1002, 1233 ],
  [ "348", 1177, 1066 ],
  [ "349", 1477, 787 ],
  [ "350", 1661, 609 ],
  [ "351", 1715, 559 ],
  [ "352", 2040, 236 ],
  [ "353", 1278, 1001 ],
  [ "354", 986, 1296 ],
  [ "355", 2015, 281 ],
  [ "356", 1327, 975 ],
  [ "357", 2199, 106 ],
  [ "358", 2088, 235 ],
  [ "359", 1073, 1252 ],
  [ "360", 1958, 368 ],
  [ "361", 1081, 1261 ],
  [ "362", 1404, 942 ],
  [ "363", 1186, 1171 ],
  [ "364", 1435, 923 ],
  [ "365", 1890, 469 ],
  [ "366", 1451, 914 ],
  [ "367", 2195, 170 ],
  [ "368", 1533, 846 ],
  [ "369", 1839, 542 ],
  [ "370", 1581, 803 ],
  [ "371", 1632, 759 ],
  [ "372", 1703, 693 ],
  [ "373", 2123, 273 ],
  [ "374", 1751, 646 ],
  [ "375", 1539, 858 ],
  [ "376", 1773, 627 ],
  [ "377", 1141, 1268 ],
  [ "378", 1815, 596 ],
  [ "379", 1764, 651 ],
  [ "380", 1871, 545 ],
  [ "381", 2067, 350 ],
  [ "382", 2113, 306 ],
  [ "383", 1887, 538 ],
  [ "384", 2194, 236 ],
  [ "385", 1738, 698 ],
  [ "386", 1902, 539 ],
  [ "387", 1150, 1296 ],
  [ "388", 2173, 275 ],
  [ "389", 1946, 515 ],
  [ "390", 2086, 377 ],
  [ "391", 1664, 801 ],
  [ "392", 1918, 549 ],
  [ "393", 1908, 561 ],
  [ "394", 1536, 934 ],
  [ "395", 1805, 667 ],
  [ "396", 1992, 496 ],
  [ "397", 1628, 860 ],
  [ "398", 1864, 631 ],
  [ "399", 1796, 705 ],
  [ "400", 2111, 392 ],
  [ "401", 2152, 354 ],
  [ "402", 1651, 861 ],
  [ "403", 1864, 671 ],
  [ "404", 1796, 740 ],
  [ "405", 1347, 1192 ],
  [ "406", 2072, 484 ],
  [ "407", 2132, 426 ],
  [ "408", 1612, 951 ],
  [ "409", 1960, 605 ],
  [ "410", 1787, 782 ],
  [ "411", 2093, 476 ],
  [ "412", 1332, 1237 ],
  [ "413", 2154, 431 ],
  [ "414", 2179, 414 ],
  [ "415", 2029, 571 ],
  [ "416", 1817, 791 ],
  [ "417", 1614, 1011 ],
  [ "418", 1348, 1281 ],
  [ "419", 1426, 1212 ],
  [ "420", 1992, 651 ],
  [ "421", 1842, 802 ],
  [ "422", 1433, 1221 ],
  [ "423", 1860, 805 ],
  [ "424", 1740, 927 ],
  [ "425", 1993, 678 ],
  [ "426", 1405, 1272 ],
  [ "427", 1885, 806 ],
  [ "428", 1988, 711 ],
  [ "429", 2122, 592 ],
  [ "430", 2046, 669 ],
  [ "431", 1708, 1012 ],
  [ "432", 1644, 1077 ],
  [ "433", 2045, 679 ],
  [ "434", 1922, 806 ],
  [ "435", 1979, 755 ],
  [ "436", 2045, 693 ],
  [ "437", 2071, 668 ],
  [ "438", 2045, 701 ],
  [ "439", 2035, 713 ],
  [ "440", 1736, 1012 ],
  [ "441", 1854, 901 ],
  [ "442", 2151, 606 ],
  [ "443", 2071, 692 ],
  [ "444", 1489, 1281 ],
  [ "445", 1974, 808 ],
  [ "446", 1736, 1057 ],
  [ "447", 1918, 877 ],
  [ "448", 1725, 1077 ],
  [ "449", 2177, 634 ],
  [ "450", 2101, 716 ],
  [ "451", 1532, 1291 ],
  [ "452", 1972, 852 ],
  [ "453", 1734, 1093 ],
  [ "454", 1992, 843 ],
  [ "455", 1746, 1093 ],
  [ "456", 2145, 705 ],
  [ "457", 2026, 827 ],
  [ "458", 2053, 820 ],
  [ "459", 1601, 1275 ],
  [ "460", 2083, 819 ],
  [ "461", 1634, 1270 ],
  [ "462", 1659, 1252 ],
  [ "463", 1992, 933 ],
  [ "464", 2051, 875 ],
  [ "465", 1794, 1145 ],
  [ "466", 1681, 1260 ],
  [ "467", 1867, 1076 ],
  [ "468", 2118, 827 ],
  [ "469", 2092, 853 ],
  [ "470", 2226, 720 ],
  [ "471", 1806, 1141 ],
  [ "472", 2033, 922 ],
  [ "473", 1681, 1275 ],
  [ "474", 2224, 740 ],
  [ "475", 2060, 908 ],
  [ "476", 2153, 820 ],
  [ "477", 2000, 977 ],
  [ "478", 1867, 1111 ],
  [ "479", 2068, 926 ],
  [ "480", 2217, 785 ],
  [ "481", 1730, 1275 ],
  [ "482", 1866, 1139 ],
  [ "483", 1996, 1011 ],
  [ "484", 2087, 921 ],
  [ "485", 2241, 770 ],
  [ "486", 2093, 934 ],
  [ "487", 2067, 960 ],
  [ "488", 2226, 807 ],
  [ "489", 2143, 893 ],
  [ "490", 1986, 1059 ],
  [ "491", 2112, 937 ],
  [ "492", 2131, 930 ],
  [ "493", 1808, 1262 ],
  [ "494", 2257, 813 ],
  [ "495", 2226, 848 ],
  [ "496", 2161, 917 ],
  [ "497", 2239, 842 ],
  [ "498", 2138, 947 ],
  [ "499", 1974, 1112 ],
  [ "500", 2015, 1076 ],
  [ "501", 2265, 834 ],
  [ "502", 2005, 1095 ],
  [ "503", 1992, 1110 ],
  [ "504", 2128, 975 ],
  [ "505", 2141, 967 ],
  [ "506", 2041, 1081 ],
  [ "507", 1889, 1236 ],
  [ "508", 1975, 1164 ],
  [ "509", 2182, 958 ],
  [ "510", 1926, 1223 ],
  [ "511", 1958, 1191 ],
  [ "512", 2197, 972 ],
  [ "513", 1928, 1250 ],
  [ "514", 2012, 1166 ],
  [ "515", 2228, 952 ],
  [ "516", 1889, 1293 ],
  [ "517", 2215, 972 ],
  [ "518", 2262, 934 ],
  [ "519", 2024, 1178 ],
  [ "520", 2097, 1106 ],
  [ "521", 2108, 1098 ],
  [ "522", 2132, 1084 ],
  [ "523", 2048, 1170 ],
  [ "524", 2202, 1022 ],
  [ "525", 2180, 1045 ],
  [ "526", 2226, 1005 ],
  [ "527", 2116, 1116 ],
  [ "528", 1939, 1294 ],
  [ "529", 2075, 1177 ],
  [ "530", 2144, 1119 ],
  [ "531", 2162, 1160 ],
  [ "532", 2142, 1220 ],
  [ "533", 2117, 1264 ],
].map(function(v) {
  const [label, x, y] = v;
  return {
    label: label,
    x: x,
    y: y,
    done: false,
    color: null,
    dist: Infinity,
    prev: null
  }
});
const edges = [
  [ "0", "4", 76.16 ],
  [ "1", "0", 33.24 ],
  [ "2", "1", 84.12 ],
  [ "4", "7", 41.01 ],
  [ "4", "8", 48.04 ],
  [ "5", "2", 92.13 ],
  [ "5", "10", 57.01 ],
  [ "6", "3", 41.01 ],
  [ "6", "16", 113.02 ],
  [ "7", "6", 9.22 ],
  [ "8", "11", 48.01 ],
  [ "8", "12", 81.02 ],
  [ "10", "13", 65.12 ],
  [ "11", "14", 36.06 ],
  [ "12", "7", 63.03 ],
  [ "12", "20", 51.92 ],
  [ "13", "9", 58.14 ],
  [ "13", "23", 88.02 ],
  [ "14", "19", 51.04 ],
  [ "14", "25", 100.02 ],
  [ "15", "10", 68.01 ],
  [ "15", "26", 98.08 ],
  [ "15", "32", 145.09 ],
  [ "16", "17", 35.01 ],
  [ "17", "18", 13.60 ],
  [ "18", "21", 29.02 ],
  [ "19", "22", 30.00 ],
  [ "20", "11", 94.00 ],
  [ "21", "29", 41.44 ],
  [ "22", "24", 25.94 ],
  [ "23", "24", 11.05 ],
  [ "23", "28", 82.76 ],
  [ "24", "44", 158.01 ],
  [ "25", "20", 34.93 ],
  [ "25", "31", 33.73 ],
  [ "26", "28", 17.03 ],
  [ "26", "40", 115.04 ],
  [ "27", "38", 82.39 ],
  [ "28", "35", 57.00 ],
  [ "29", "27", 9.22 ],
  [ "30", "19", 85.05 ],
  [ "30", "31", 26.25 ],
  [ "32", "36", 45.04 ],
  [ "32", "39", 68.12 ],
  [ "33", "29", 32.06 ],
  [ "33", "42", 81.15 ],
  [ "34", "31", 23.43 ],
  [ "35", "41", 65.15 ],
  [ "36", "45", 69.03 ],
  [ "37", "36", 21.10 ],
  [ "38", "34", 26.93 ],
  [ "38", "42", 38.33 ],
  [ "40", "49", 56.75 ],
  [ "41", "53", 89.01 ],
  [ "42", "46", 29.15 ],
  [ "43", "37", 43.19 ],
  [ "44", "53", 53.00 ],
  [ "45", "39", 43.01 ],
  [ "46", "50", 32.39 ],
  [ "46", "59", 108.02 ],
  [ "47", "43", 80.53 ],
  [ "48", "55", 62.01 ],
  [ "48", "60", 104.04 ],
  [ "50", "62", 65.80 ],
  [ "51", "57", 71.45 ],
  [ "52", "63", 94.02 ],
  [ "52", "77", 165.19 ],
  [ "53", "66", 98.05 ],
  [ "54", "47", 39.05 ],
  [ "54", "57", 58.42 ],
  [ "54", "68", 101.00 ],
  [ "55", "63", 59.03 ],
  [ "56", "51", 53.24 ],
  [ "56", "70", 61.03 ],
  [ "57", "70", 59.21 ],
  [ "58", "68", 40.00 ],
  [ "59", "53", 69.07 ],
  [ "59", "69", 37.05 ],
  [ "60", "50", 94.13 ],
  [ "61", "49", 70.72 ],
  [ "61", "75", 92.20 ],
  [ "62", "85", 84.50 ],
  [ "63", "65", 9.00 ],
  [ "64", "55", 65.01 ],
  [ "65", "81", 76.06 ],
  [ "66", "72", 90.55 ],
  [ "67", "79", 70.00 ],
  [ "68", "73", 42.01 ],
  [ "70", "75", 57.31 ],
  [ "72", "88", 150.99 ],
  [ "73", "80", 28.02 ],
  [ "73", "83", 38.01 ],
  [ "75", "88", 64.12 ],
  [ "76", "74", 16.00 ],
  [ "76", "91", 80.01 ],
  [ "77", "89", 58.14 ],
  [ "78", "111", 166.00 ],
  [ "79", "65", 84.38 ],
  [ "79", "96", 99.32 ],
  [ "80", "71", 43.00 ],
  [ "80", "90", 56.04 ],
  [ "81", "86", 16.28 ],
  [ "82", "107", 137.36 ],
  [ "84", "76", 26.02 ],
  [ "84", "99", 80.01 ],
  [ "85", "84", 9.90 ],
  [ "86", "95", 68.18 ],
  [ "88", "105", 77.06 ],
  [ "89", "101", 51.24 ],
  [ "90", "94", 31.06 ],
  [ "91", "100", 20.59 ],
  [ "92", "104", 45.00 ],
  [ "92", "118", 180.47 ],
  [ "93", "89", 32.02 ],
  [ "94", "87", 59.01 ],
  [ "94", "112", 79.01 ],
  [ "95", "79", 91.02 ],
  [ "97", "85", 53.00 ],
  [ "98", "122", 162.00 ],
  [ "100", "109", 39.00 ],
  [ "101", "106", 29.07 ],
  [ "102", "88", 63.01 ],
  [ "104", "109", 24.52 ],
  [ "104", "125", 182.58 ],
  [ "105", "107", 10.05 ],
  [ "105", "114", 51.04 ],
  [ "106", "93", 50.04 ],
  [ "107", "118", 95.08 ],
  [ "108", "77", 134.37 ],
  [ "108", "103", 30.41 ],
  [ "108", "115", 58.55 ],
  [ "109", "121", 111.02 ],
  [ "110", "97", 37.20 ],
  [ "110", "116", 40.31 ],
  [ "111", "90", 106.00 ],
  [ "112", "102", 61.01 ],
  [ "112", "139", 203.00 ],
  [ "113", "102", 61.01 ],
  [ "114", "113", 17.00 ],
  [ "115", "101", 79.16 ],
  [ "115", "138", 199.83 ],
  [ "116", "96", 123.69 ],
  [ "117", "127", 104.00 ],
  [ "118", "123", 23.19 ],
  [ "119", "131", 86.15 ],
  [ "120", "103", 96.52 ],
  [ "120", "129", 45.45 ],
  [ "121", "116", 50.00 ],
  [ "121", "134", 88.05 ],
  [ "122", "111", 96.02 ],
  [ "123", "125", 21.02 ],
  [ "123", "140", 118.02 ],
  [ "125", "131", 43.42 ],
  [ "126", "112", 111.04 ],
  [ "126", "140", 94.00 ],
  [ "127", "146", 102.00 ],
  [ "127", "159", 169.00 ],
  [ "128", "136", 33.02 ],
  [ "129", "132", 13.04 ],
  [ "129", "144", 105.02 ],
  [ "130", "141", 64.00 ],
  [ "131", "142", 48.04 ],
  [ "132", "124", 99.01 ],
  [ "133", "120", 133.76 ],
  [ "133", "135", 9.22 ],
  [ "134", "137", 12.04 ],
  [ "135", "145", 53.24 ],
  [ "136", "152", 106.23 ],
  [ "137", "148", 63.29 ],
  [ "138", "162", 137.03 ],
  [ "139", "122", 113.00 ],
  [ "139", "158", 109.00 ],
  [ "139", "159", 109.00 ],
  [ "140", "151", 63.01 ],
  [ "140", "178", 200.02 ],
  [ "141", "137", 26.68 ],
  [ "141", "147", 38.05 ],
  [ "142", "130", 73.55 ],
  [ "143", "151", 56.01 ],
  [ "144", "135", 43.05 ],
  [ "146", "155", 53.00 ],
  [ "146", "157", 68.00 ],
  [ "147", "171", 134.03 ],
  [ "148", "128", 108.07 ],
  [ "148", "152", 30.02 ],
  [ "149", "144", 23.41 ],
  [ "150", "147", 24.02 ],
  [ "150", "153", 18.38 ],
  [ "151", "156", 27.02 ],
  [ "152", "160", 36.12 ],
  [ "153", "142", 63.29 ],
  [ "153", "170", 93.05 ],
  [ "154", "149", 44.64 ],
  [ "155", "168", 68.01 ],
  [ "156", "167", 65.01 ],
  [ "157", "165", 29.00 ],
  [ "157", "168", 52.00 ],
  [ "158", "126", 199.01 ],
  [ "159", "172", 75.01 ],
  [ "160", "184", 98.08 ],
  [ "162", "179", 82.01 ],
  [ "162", "205", 144.78 ],
  [ "163", "182", 90.27 ],
  [ "164", "132", 119.67 ],
  [ "166", "155", 56.01 ],
  [ "166", "190", 88.01 ],
  [ "167", "161", 40.01 ],
  [ "167", "208", 136.00 ],
  [ "169", "179", 38.01 ],
  [ "170", "173", 11.00 ],
  [ "170", "188", 56.01 ],
  [ "171", "160", 65.07 ],
  [ "171", "174", 8.06 ],
  [ "172", "181", 25.00 ],
  [ "173", "156", 90.01 ],
  [ "175", "169", 25.00 ],
  [ "176", "164", 49.24 ],
  [ "177", "167", 38.00 ],
  [ "178", "158", 93.01 ],
  [ "178", "201", 71.01 ],
  [ "178", "208", 91.01 ],
  [ "179", "185", 17.00 ],
  [ "180", "176", 14.14 ],
  [ "180", "234", 196.31 ],
  [ "181", "166", 60.00 ],
  [ "181", "191", 32.02 ],
  [ "183", "163", 77.41 ],
  [ "183", "247", 240.02 ],
  [ "184", "198", 56.22 ],
  [ "184", "200", 53.08 ],
  [ "185", "189", 11.05 ],
  [ "185", "211", 76.01 ],
  [ "186", "172", 45.01 ],
  [ "187", "173", 45.00 ],
  [ "187", "195", 20.40 ],
  [ "189", "175", 37.22 ],
  [ "190", "197", 16.12 ],
  [ "192", "201", 29.02 ],
  [ "193", "210", 45.00 ],
  [ "194", "174", 69.03 ],
  [ "194", "206", 37.12 ],
  [ "194", "212", 60.01 ],
  [ "195", "228", 106.12 ],
  [ "197", "207", 80.95 ],
  [ "198", "203", 16.28 ],
  [ "199", "183", 76.69 ],
  [ "200", "189", 38.01 ],
  [ "200", "219", 55.44 ],
  [ "201", "214", 44.01 ],
  [ "202", "180", 81.22 ],
  [ "202", "238", 120.51 ],
  [ "203", "174", 92.05 ],
  [ "205", "218", 24.76 ],
  [ "206", "210", 17.09 ],
  [ "207", "191", 38.59 ],
  [ "207", "215", 57.31 ],
  [ "207", "223", 35.85 ],
  [ "208", "232", 91.01 ],
  [ "211", "204", 19.03 ],
  [ "211", "225", 51.01 ],
  [ "212", "227", 34.83 ],
  [ "213", "201", 38.05 ],
  [ "214", "159", 201.09 ],
  [ "215", "237", 66.73 ],
  [ "216", "187", 89.01 ],
  [ "216", "232", 69.00 ],
  [ "216", "249", 139.01 ],
  [ "217", "196", 63.01 ],
  [ "217", "215", 11.40 ],
  [ "217", "229", 118.07 ],
  [ "218", "236", 70.61 ],
  [ "219", "198", 51.04 ],
  [ "220", "200", 57.08 ],
  [ "220", "230", 43.19 ],
  [ "221", "209", 33.73 ],
  [ "222", "202", 96.05 ],
  [ "222", "242", 85.00 ],
  [ "224", "235", 49.00 ],
  [ "225", "220", 18.00 ],
  [ "225", "239", 65.03 ],
  [ "226", "221", 20.02 ],
  [ "226", "239", 73.68 ],
  [ "227", "244", 86.05 ],
  [ "227", "250", 102.04 ],
  [ "228", "210", 72.06 ],
  [ "229", "233", 53.85 ],
  [ "229", "245", 60.54 ],
  [ "230", "243", 64.50 ],
  [ "231", "228", 12.04 ],
  [ "232", "248", 70.01 ],
  [ "233", "214", 51.04 ],
  [ "233", "248", 175.90 ],
  [ "234", "199", 119.02 ],
  [ "234", "240", 33.02 ],
  [ "235", "231", 19.03 ],
  [ "236", "222", 99.62 ],
  [ "236", "241", 52.81 ],
  [ "238", "260", 114.13 ],
  [ "239", "256", 59.00 ],
  [ "240", "251", 36.00 ],
  [ "240", "253", 41.01 ],
  [ "241", "226", 66.48 ],
  [ "241", "256", 57.01 ],
  [ "242", "260", 50.25 ],
  [ "243", "252", 22.02 ],
  [ "244", "255", 22.00 ],
  [ "244", "266", 97.25 ],
  [ "246", "235", 56.00 ],
  [ "246", "259", 47.04 ],
  [ "247", "268", 99.41 ],
  [ "248", "261", 139.19 ],
  [ "248", "286", 140.80 ],
  [ "249", "231", 81.00 ],
  [ "249", "262", 58.00 ],
  [ "250", "246", 9.22 ],
  [ "250", "263", 61.01 ],
  [ "251", "279", 175.23 ],
  [ "253", "254", 14.21 ],
  [ "254", "273", 116.00 ],
  [ "255", "230", 113.75 ],
  [ "255", "267", 63.39 ],
  [ "256", "274", 182.56 ],
  [ "256", "291", 179.23 ],
  [ "258", "269", 56.36 ],
  [ "260", "265", 21.26 ],
  [ "261", "262", 21.63 ],
  [ "261", "272", 53.71 ],
  [ "263", "287", 146.01 ],
  [ "264", "251", 66.07 ],
  [ "265", "276", 49.40 ],
  [ "266", "263", 21.02 ],
  [ "267", "274", 46.17 ],
  [ "268", "285", 112.45 ],
  [ "269", "271", 29.15 ],
  [ "270", "262", 62.01 ],
  [ "270", "280", 52.01 ],
  [ "270", "287", 81.02 ],
  [ "271", "257", 73.93 ],
  [ "273", "275", 11.70 ],
  [ "274", "289", 97.27 ],
  [ "275", "279", 25.18 ],
  [ "277", "284", 28.02 ],
  [ "278", "306", 87.97 ],
  [ "279", "292", 40.61 ],
  [ "281", "275", 46.27 ],
  [ "284", "290", 20.25 ],
  [ "285", "264", 101.27 ],
  [ "285", "294", 49.04 ],
  [ "286", "271", 179.23 ],
  [ "286", "295", 125.24 ],
  [ "287", "305", 54.01 ],
  [ "289", "266", 112.45 ],
  [ "289", "318", 158.27 ],
  [ "289", "338", 210.04 ],
  [ "290", "303", 29.55 ],
  [ "291", "308", 61.20 ],
  [ "291", "317", 115.11 ],
  [ "292", "278", 72.57 ],
  [ "293", "307", 44.60 ],
  [ "294", "296", 116.04 ],
  [ "294", "298", 78.64 ],
  [ "294", "328", 156.28 ],
  [ "295", "304", 29.15 ],
  [ "296", "297", 35.36 ],
  [ "296", "313", 33.97 ],
  [ "297", "283", 48.08 ],
  [ "297", "299", 19.85 ],
  [ "298", "285", 61.07 ],
  [ "299", "300", 40.31 ],
  [ "299", "316", 53.04 ],
  [ "300", "282", 46.67 ],
  [ "300", "301", 105.38 ],
  [ "302", "298", 17.49 ],
  [ "302", "309", 16.97 ],
  [ "303", "320", 88.05 ],
  [ "304", "288", 50.00 ],
  [ "304", "314", 71.51 ],
  [ "306", "302", 35.81 ],
  [ "306", "312", 80.62 ],
  [ "307", "281", 70.71 ],
  [ "308", "319", 71.03 ],
  [ "308", "322", 101.49 ],
  [ "309", "310", 15.65 ],
  [ "310", "315", 44.41 ],
  [ "311", "303", 34.13 ],
  [ "311", "317", 44.10 ],
  [ "311", "323", 72.25 ],
  [ "312", "293", 47.68 ],
  [ "312", "320", 148.72 ],
  [ "314", "305", 49.50 ],
  [ "314", "321", 103.12 ],
  [ "317", "325", 54.08 ],
  [ "318", "321", 43.42 ],
  [ "318", "324", 106.89 ],
  [ "319", "330", 57.94 ],
  [ "320", "323", 41.59 ],
  [ "321", "337", 116.93 ],
  [ "322", "329", 43.42 ],
  [ "323", "325", 46.07 ],
  [ "325", "330", 98.98 ],
  [ "325", "350", 155.05 ],
  [ "326", "315", 62.03 ],
  [ "326", "345", 118.71 ],
  [ "328", "335", 36.01 ],
  [ "329", "336", 30.27 ],
  [ "330", "334", 77.52 ],
  [ "331", "324", 89.47 ],
  [ "332", "344", 92.14 ],
  [ "333", "326", 55.04 ],
  [ "334", "340", 75.72 ],
  [ "334", "349", 65.74 ],
  [ "335", "341", 22.02 ],
  [ "335", "342", 45.31 ],
  [ "336", "340", 13.60 ],
  [ "337", "327", 201.38 ],
  [ "337", "339", 27.31 ],
  [ "337", "347", 67.90 ],
  [ "338", "331", 67.54 ],
  [ "338", "343", 33.24 ],
  [ "338", "364", 149.46 ],
  [ "339", "363", 148.86 ],
  [ "340", "343", 84.96 ],
  [ "341", "355", 71.02 ],
  [ "344", "346", 67.54 ],
  [ "344", "357", 82.23 ],
  [ "345", "351", 47.07 ],
  [ "346", "352", 101.12 ],
  [ "346", "367", 109.44 ],
  [ "347", "354", 65.00 ],
  [ "347", "359", 73.50 ],
  [ "348", "339", 165.05 ],
  [ "350", "345", 60.53 ],
  [ "350", "374", 97.31 ],
  [ "351", "333", 131.85 ],
  [ "352", "358", 48.01 ],
  [ "353", "348", 120.11 ],
  [ "355", "352", 51.48 ],
  [ "355", "360", 104.01 ],
  [ "356", "353", 55.47 ],
  [ "357", "367", 64.12 ],
  [ "359", "361", 12.04 ],
  [ "360", "365", 121.76 ],
  [ "361", "377", 60.41 ],
  [ "362", "356", 83.77 ],
  [ "363", "405", 162.36 ],
  [ "364", "362", 36.36 ],
  [ "364", "366", 18.36 ],
  [ "364", "394", 101.60 ],
  [ "365", "369", 89.05 ],
  [ "366", "368", 106.53 ],
  [ "367", "384", 66.01 ],
  [ "368", "370", 64.44 ],
  [ "368", "375", 13.42 ],
  [ "369", "376", 107.62 ],
  [ "370", "397", 73.88 ],
  [ "371", "370", 67.36 ],
  [ "371", "372", 96.94 ],
  [ "372", "374", 67.18 ],
  [ "372", "385", 35.36 ],
  [ "373", "382", 34.48 ],
  [ "374", "379", 13.93 ],
  [ "375", "394", 76.06 ],
  [ "376", "374", 29.07 ],
  [ "377", "387", 29.41 ],
  [ "378", "380", 75.74 ],
  [ "379", "378", 75.01 ],
  [ "380", "383", 17.46 ],
  [ "381", "355", 86.40 ],
  [ "382", "381", 63.66 ],
  [ "383", "386", 15.03 ],
  [ "384", "388", 44.29 ],
  [ "386", "392", 18.87 ],
  [ "388", "373", 50.04 ],
  [ "389", "396", 49.77 ],
  [ "390", "381", 33.02 ],
  [ "391", "371", 52.80 ],
  [ "392", "389", 44.05 ],
  [ "392", "393", 15.62 ],
  [ "393", "398", 82.68 ],
  [ "394", "408", 77.88 ],
  [ "395", "379", 44.01 ],
  [ "395", "399", 39.05 ],
  [ "396", "406", 80.89 ],
  [ "397", "402", 23.02 ],
  [ "398", "403", 40.00 ],
  [ "399", "404", 35.00 ],
  [ "400", "390", 29.15 ],
  [ "400", "407", 39.96 ],
  [ "401", "400", 55.90 ],
  [ "402", "391", 61.39 ],
  [ "403", "395", 59.14 ],
  [ "403", "425", 129.19 ],
  [ "404", "410", 42.95 ],
  [ "404", "435", 183.61 ],
  [ "405", "412", 47.43 ],
  [ "405", "419", 81.49 ],
  [ "406", "411", 22.47 ],
  [ "407", "413", 22.56 ],
  [ "408", "417", 60.03 ],
  [ "408", "424", 130.23 ],
  [ "409", "392", 70.00 ],
  [ "409", "415", 76.92 ],
  [ "410", "416", 31.32 ],
  [ "411", "407", 63.41 ],
  [ "412", "418", 46.82 ],
  [ "413", "414", 30.23 ],
  [ "414", "401", 65.80 ],
  [ "415", "429", 95.34 ],
  [ "417", "431", 94.01 ],
  [ "418", "426", 57.71 ],
  [ "419", "422", 11.40 ],
  [ "420", "409", 56.04 ],
  [ "423", "421", 18.25 ],
  [ "423", "427", 25.02 ],
  [ "424", "441", 116.93 ],
  [ "425", "420", 27.02 ],
  [ "425", "428", 33.38 ],
  [ "426", "444", 84.48 ],
  [ "428", "439", 47.04 ],
  [ "429", "442", 32.20 ],
  [ "430", "433", 10.05 ],
  [ "431", "440", 28.00 ],
  [ "433", "425", 52.01 ],
  [ "433", "436", 14.00 ],
  [ "434", "447", 71.11 ],
  [ "435", "428", 44.91 ],
  [ "435", "445", 53.24 ],
  [ "436", "443", 26.02 ],
  [ "437", "430", 25.02 ],
  [ "438", "436", 8.00 ],
  [ "439", "438", 15.62 ],
  [ "439", "450", 66.07 ],
  [ "440", "446", 45.00 ],
  [ "441", "423", 96.19 ],
  [ "441", "447", 68.35 ],
  [ "442", "449", 38.21 ],
  [ "443", "437", 24.00 ],
  [ "444", "451", 44.15 ],
  [ "445", "434", 52.04 ],
  [ "445", "452", 44.05 ],
  [ "446", "448", 22.83 ],
  [ "447", "452", 59.51 ],
  [ "448", "432", 81.00 ],
  [ "448", "453", 18.36 ],
  [ "449", "470", 98.98 ],
  [ "450", "456", 45.35 ],
  [ "451", "459", 70.83 ],
  [ "453", "455", 12.00 ],
  [ "454", "452", 21.93 ],
  [ "454", "472", 89.01 ],
  [ "455", "465", 70.77 ],
  [ "457", "454", 37.58 ],
  [ "458", "457", 27.89 ],
  [ "459", "461", 33.38 ],
  [ "460", "458", 30.02 ],
  [ "461", "473", 47.27 ],
  [ "462", "466", 23.41 ],
  [ "463", "452", 83.43 ],
  [ "464", "469", 46.53 ],
  [ "465", "471", 12.65 ],
  [ "468", "460", 35.90 ],
  [ "470", "474", 20.10 ],
  [ "471", "482", 60.03 ],
  [ "472", "475", 30.41 ],
  [ "473", "466", 15.00 ],
  [ "473", "481", 49.00 ],
  [ "474", "485", 34.48 ],
  [ "475", "464", 34.21 ],
  [ "475", "479", 19.70 ],
  [ "476", "468", 35.69 ],
  [ "477", "463", 44.72 ],
  [ "478", "467", 35.00 ],
  [ "478", "499", 107.00 ],
  [ "479", "484", 19.65 ],
  [ "479", "487", 34.01 ],
  [ "480", "476", 72.95 ],
  [ "480", "488", 23.77 ],
  [ "481", "493", 79.08 ],
  [ "482", "478", 28.02 ],
  [ "483", "477", 34.23 ],
  [ "484", "486", 14.32 ],
  [ "485", "480", 28.30 ],
  [ "486", "491", 19.24 ],
  [ "488", "494", 31.58 ],
  [ "488", "497", 37.34 ],
  [ "489", "468", 70.58 ],
  [ "490", "483", 49.03 ],
  [ "490", "500", 33.62 ],
  [ "491", "492", 20.25 ],
  [ "492", "496", 32.70 ],
  [ "492", "498", 18.38 ],
  [ "493", "507", 85.07 ],
  [ "494", "501", 22.47 ],
  [ "496", "489", 30.00 ],
  [ "496", "509", 46.07 ],
  [ "497", "495", 14.32 ],
  [ "498", "505", 20.22 ],
  [ "499", "490", 54.34 ],
  [ "499", "508", 52.01 ],
  [ "500", "506", 26.48 ],
  [ "502", "500", 21.47 ],
  [ "503", "502", 19.85 ],
  [ "504", "491", 41.23 ],
  [ "505", "504", 15.26 ],
  [ "507", "510", 39.22 ],
  [ "507", "516", 57.00 ],
  [ "509", "512", 20.52 ],
  [ "510", "511", 45.25 ],
  [ "510", "513", 27.07 ],
  [ "511", "508", 31.91 ],
  [ "512", "517", 18.00 ],
  [ "513", "528", 45.35 ],
  [ "514", "503", 59.46 ],
  [ "515", "518", 38.47 ],
  [ "517", "515", 23.85 ],
  [ "517", "526", 34.79 ],
  [ "519", "514", 16.97 ],
  [ "520", "529", 74.33 ],
  [ "521", "472", 191.31 ],
  [ "521", "520", 13.60 ],
  [ "521", "527", 19.70 ],
  [ "522", "521", 27.78 ],
  [ "523", "519", 25.30 ],
  [ "524", "525", 31.83 ],
  [ "525", "522", 61.85 ],
  [ "526", "524", 29.41 ],
  [ "527", "530", 28.16 ],
  [ "529", "523", 27.89 ],
  [ "530", "531", 44.78 ],
  [ "531", "532", 63.25 ],
  [ "532", "533", 50.61 ],
].map(function(v) {
  const [from, to, w] = v;
  return {
    from: nodes.find(x => x.label == from),
    to: nodes.find(x => x.label == to),
    weight: w,
    done: false,
    color: null
  }
});
function get_edge(u, v) {
  for (const edge of edges) {
    if (edge.from === u && edge.to === v)
      return edge;
    else if (edge.to === u && edge.from === v)
      return edge;
  }
  return null;
}
function initialize() {
  state.S.clear();
  nodes.forEach(function (node) {
    node.dist = Infinity;
    node.prev = null;
    node.done = false; node.color = null;
  });
  edges.forEach(function (edge) {
    edge.done = false;
    edge.color = null;
  });
}
window.preload = function() {
  img = loadImage("/image/nagitsuji_map_gray.png");
}
window.setup = function() {
  const canvas = createCanvas(cv.w, cv.h);
  canvas.parent('canvas-hole');
  noLoop();

  textSize(cv.text_sz);

  initialize();
  const s = cv.start_node;
  nodes[s].dist = 0;
  for (let i = 0; i < nodes.length; i++) {
    $("#start").append($("<option>").html(nodes[i].label).val(i));
  }
  $("#start").val(s);
}
function draw_node(node) {
  const node_d = cv.node_r * 2;
  stroke(0, 0, 0);
  strokeWeight(2);

  fill.apply(null, node.color);
  ellipse(node.x, node.y, node_d, node_d);

  textAlign(CENTER, CENTER);
  fill(0);
  text(node.label, node.x, node.y);
}
function draw_edge(edge) {
  const [n1, n2] = [edge.from, edge.to];
  const [x1, y1] = [n1.x, n1.y];
  const [x2, y2] = [n2.x, n2.y];

  strokeWeight(2);
  fill.apply(null, edge.color);
  stroke.apply(null, edge.color);
  line(x1, y1, x2, y2);

  const [lx, ly] = [(x1+x2)/2, (y1+y2)/2];
  textAlign(CENTER, CENTER);
  fill(0);
  stroke(255, 255, 255);
  strokeWeight(5);
  text(edge.weight, lx, ly);
}
function draw_graph() {
  edges.forEach(draw_edge);
  nodes.forEach(draw_node);
}
function draw_status() {
  strokeWeight(1);
  textAlign(LEFT, TOP);
  text("S = {" + Array.from(state.S).map((v) => v.label).join(", ") + "}", 600, 25);
  for (i = 0; i < nodes.length; i++) {
    const node = nodes[i];
    text("d[" + node.label + "] = " + (node.dist==Infinity?"∞":node.dist), 600, 25+50*(i+1));
    text("prev[" + node.label + "] = " + (node.prev?node.prev.label:null), 750, 25+50*(i+1));
  }
}
function table_refresh() {
  $('#tbl td').parent().empty();
  if ($('#tbl tbody').length == 0) {
    $('#tbl').append($('<tbody>'));
  }
  for (let i = 0; i < nodes.length; i++) {
    const node = nodes[i];
    const d = "d[" + node.label + "] = " + (node.dist==Infinity?"∞":node.dist);
    const prev = "prev[" + node.label + "] = " + (node.prev?node.prev.label:"NULL");

    $('#tbl tbody').append('<tr>' +
                     '<td>' + node.label + '</td>' +
                     '<td>' + d + '</td>' +
                     '<td>' + prev + '</td>' +
                     '</tr>');
  }
}
function get_node(px, py) {
  for (const node of nodes) {
    const [qx, qy] = [node.x, node.y];
    const [x, y] = [px-qx, py-qy]
    if (x*x+y*y <= cv.node_r*cv.node_r)
      return node;
  }
  return null;
}
function is_shortest_path() {
  const node =get_node(mouseX, mouseY);
  return node ? node.done : false;
}
function set_color() {
  nodes.forEach(function (node) {
    if (node.done)
      node.color = color_code.red;
    else if (node == nodes[$('#start').val()])
      node.color = color_code.blue;
    else
      node.color = [255, 255, 255];
  });
  edges.forEach(function (edge) {
    edge.color = edge.done ? color_code.red : color_code.black;
  });

  if (state.mode == path_mode) {
    var node = get_node(mouseX, mouseY);
    do {
      const p = node.prev;
      const e = get_edge(p, node); 
      if (e)
        e.color = color_code.yellow;
      node.color = color_code.yellow;
      node = p;
    } while (node);
  }
}
window.draw = function() {
  background(200);

  if (state.image_load) {
    const offset = 0;
    image(img, -offset, -offset, cv.w-offset, cv.h-offset);
  }

  state.mode = is_shortest_path() ? path_mode : normal_mode;
  if (state.graph_draw) {
    set_color();
    draw_graph();
  }
  table_refresh();
}
window.mouseMoved = function() {
  if (state.mode == normal_mode && is_shortest_path())
    redraw();
  if (state.mode == path_mode && !is_shortest_path())
    redraw();
}
function dijkstra() {
  if (state.S.size < nodes.length) {
    const u = nodes.filter((v) => !state.S.has(v))
                   .reduce((acc, val) => acc.dist < val.dist ? acc : val);
    for (const edge of edges) {
      if (edge.from == u || edge.to == u) {
        const t = edge.from == u ? edge.to : edge.from;
        const w = edge.weight;
        const u2t_w = u.dist + w;
        if (t.dist > u2t_w) {
          t.dist = u2t_w;
          t.prev = u;
        }
        edge.done = true;
      }
    }
    u.done = true;
    state.S.add(u);
  }
}
$(document).ready(function() {
  $("#search").click(function() {
    dijkstra();
    redraw();
  });
  $("#goal").click(function() {
    while (state.S.size < nodes.length)
      dijkstra();
    redraw();
  });
  $('#reset').click(function() {
    initialize();
    nodes[$('#start').val()].dist = 0;
    draw();
    redraw();
  });
  $('#start').change(function() {
    initialize();
    const i = $(this).val();
    console.log(i);
    nodes[i].dist = 0;
    draw();
    redraw();
  });
  $('#image_load').click(function() {
    state.image_load = !state.image_load;
    redraw();
  });
  $('#graph_draw').click(function() {
    state.graph_draw = !state.graph_draw;
    redraw();
  });
});
